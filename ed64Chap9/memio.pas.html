<HTML>
<HEAD>
<TITLE>memio.pas</TITLE>
<STYLE TYPE="text/css"><!--
.syntax0 {
color: #000000;
}
.syntax1 {
color: #cc0000;
}
.syntax2 {
color: #ff8400;
}
.syntax3 {
color: #6600cc;
}
.syntax4 {
color: #cc6600;
}
.syntax5 {
color: #ff0000;
}
.syntax6 {
color: #9966ff;
}
.syntax7 {
background: #ffffcc;
color: #ff0066;
}
.syntax8 {
color: #006699;
font-weight: bold;
}
.syntax9 {
color: #009966;
font-weight: bold;
}
.syntax10 {
color: #0099ff;
font-weight: bold;
}
.syntax11 {
color: #66ccff;
font-weight: bold;
}
.syntax12 {
color: #02b902;
}
.syntax13 {
color: #ff00cc;
}
.syntax14 {
color: #cc00cc;
}
.syntax15 {
color: #9900cc;
}
.syntax16 {
color: #6600cc;
}
.syntax17 {
color: #0000ff;
}
.syntax18 {
color: #000000;
font-weight: bold;
}
.gutter {
background: #dbdbdb;
color: #000000;
}
.gutterH {
background: #dbdbdb;
color: #990066;
}
-->
</STYLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<PRE><SPAN CLASS="gutter">   1:</SPAN><SPAN CLASS="syntax1">(*</SPAN><SPAN CLASS="syntax1">****************************************************************</SPAN>
<SPAN CLASS="gutter">   2:</SPAN><SPAN CLASS="syntax1">*</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">ED64</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">:</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">EL</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">DENDO's</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">Commodore</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">64</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">emulator</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">*</SPAN>
<SPAN CLASS="gutter">   3:</SPAN><SPAN CLASS="syntax1">*</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">Memory</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">and</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">IO</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">unit</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">*</SPAN>
<SPAN CLASS="gutter">   4:</SPAN><SPAN CLASS="syntax1">*</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">(c)</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">2006,</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">2007</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">by</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">ir.</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">Marc</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">Dendooven</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">*</SPAN>
<SPAN CLASS="gutterH">   5:</SPAN><SPAN CLASS="syntax1">*</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">Versie</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">Chapter</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">9</SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1"> </SPAN><SPAN CLASS="syntax1">*</SPAN>
<SPAN CLASS="gutter">   6:</SPAN><SPAN CLASS="syntax1">****************************************************************</SPAN><SPAN CLASS="syntax1">*)</SPAN>
<SPAN CLASS="gutter">   7:</SPAN><SPAN CLASS="syntax8">unit</SPAN> memio<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">   8:</SPAN><SPAN CLASS="syntax1">(*</SPAN><SPAN CLASS="syntax1">**************************************************************</SPAN><SPAN CLASS="syntax1">*)</SPAN>
<SPAN CLASS="gutter">   9:</SPAN><SPAN CLASS="syntax8">interface</SPAN>
<SPAN CLASS="gutterH">  10:</SPAN>
<SPAN CLASS="gutter">  11:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> poke<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN> <SPAN CLASS="syntax18">;</SPAN> value <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  12:</SPAN><SPAN CLASS="syntax8">function</SPAN>  peek<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  13:</SPAN><SPAN CLASS="syntax8">function</SPAN>  vicPeek<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  14:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> setVicWatchRange<SPAN CLASS="syntax18">(</SPAN>startAddress<SPAN CLASS="syntax18">,</SPAN>endAddress <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  15:</SPAN><SPAN CLASS="syntax1">(*</SPAN><SPAN CLASS="syntax1">**************************************************************</SPAN><SPAN CLASS="syntax1">*)</SPAN>
<SPAN CLASS="gutter">  16:</SPAN>
<SPAN CLASS="gutter">  17:</SPAN>
<SPAN CLASS="gutter">  18:</SPAN><SPAN CLASS="syntax8">implementation</SPAN>
<SPAN CLASS="gutter">  19:</SPAN>
<SPAN CLASS="gutterH">  20:</SPAN><SPAN CLASS="syntax8">uses</SPAN> vic<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  21:</SPAN>
<SPAN CLASS="gutter">  22:</SPAN><SPAN CLASS="syntax8">var</SPAN>
<SPAN CLASS="gutter">  23:</SPAN>    ram         <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">array</SPAN> <SPAN CLASS="syntax18">[</SPAN>$<SPAN CLASS="syntax5">0000</SPAN><SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$FFFF<SPAN CLASS="syntax18">]</SPAN> <SPAN CLASS="syntax8">of</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  24:</SPAN>    basic_rom   <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">array</SPAN> <SPAN CLASS="syntax18">[</SPAN>$A000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$BFFF<SPAN CLASS="syntax18">]</SPAN> <SPAN CLASS="syntax8">of</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  25:</SPAN>    kernal_rom  <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">array</SPAN> <SPAN CLASS="syntax18">[</SPAN>$E000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$FFFF<SPAN CLASS="syntax18">]</SPAN> <SPAN CLASS="syntax8">of</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  26:</SPAN>    char_rom    <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">array</SPAN> <SPAN CLASS="syntax18">[</SPAN>$D000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$DFFF<SPAN CLASS="syntax18">]</SPAN> <SPAN CLASS="syntax8">of</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  27:</SPAN>
<SPAN CLASS="gutter">  28:</SPAN>    loram<SPAN CLASS="syntax18">,</SPAN> hiram<SPAN CLASS="syntax18">,</SPAN> charen <SPAN CLASS="syntax18">,</SPAN> hiANDlo<SPAN CLASS="syntax18">,</SPAN> hiORlo<SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">boolean</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  29:</SPAN>
<SPAN CLASS="gutterH">  30:</SPAN>    watchVicFrom<SPAN CLASS="syntax18">,</SPAN>watchVicTo <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  31:</SPAN>
<SPAN CLASS="gutter">  32:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> setVicWatchRange<SPAN CLASS="syntax18">(</SPAN>startAddress<SPAN CLASS="syntax18">,</SPAN>endAddress <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  33:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  34:</SPAN>    watchVicFrom <SPAN CLASS="syntax18">:=</SPAN> startAddress<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  35:</SPAN>    watchVicTo <SPAN CLASS="syntax18">:=</SPAN> endAddress<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  36:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  37:</SPAN>
<SPAN CLASS="gutter">  38:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> ioport<SPAN CLASS="syntax18">(</SPAN>port <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  39:</SPAN><SPAN CLASS="syntax8">var</SPAN>     maskedPort <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  40:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  41:</SPAN>        maskedPort     <SPAN CLASS="syntax18">:=</SPAN> port <SPAN CLASS="syntax8">and</SPAN> ram<SPAN CLASS="syntax18">[</SPAN><SPAN CLASS="syntax5">0</SPAN><SPAN CLASS="syntax18">]</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  42:</SPAN>        loram          <SPAN CLASS="syntax18">:=</SPAN> <SPAN CLASS="syntax10">boolean</SPAN> <SPAN CLASS="syntax18">(</SPAN>maskedport <SPAN CLASS="syntax8">and</SPAN> <SPAN CLASS="syntax5">1</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  43:</SPAN>        hiram          <SPAN CLASS="syntax18">:=</SPAN> <SPAN CLASS="syntax10">boolean</SPAN> <SPAN CLASS="syntax18">(</SPAN>maskedPort <SPAN CLASS="syntax8">and</SPAN> <SPAN CLASS="syntax5">2</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  44:</SPAN>        charen         <SPAN CLASS="syntax18">:=</SPAN> <SPAN CLASS="syntax10">boolean</SPAN> <SPAN CLASS="syntax18">(</SPAN>maskedport <SPAN CLASS="syntax8">and</SPAN> <SPAN CLASS="syntax5">4</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  45:</SPAN>        hiANDlo        <SPAN CLASS="syntax18">:=</SPAN> hiram <SPAN CLASS="syntax8">and</SPAN> loram<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  46:</SPAN>        hiORlo         <SPAN CLASS="syntax18">:=</SPAN> hiram <SPAN CLASS="syntax8">or</SPAN> loram<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  47:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  48:</SPAN>
<SPAN CLASS="gutter">  49:</SPAN><SPAN CLASS="syntax8">function</SPAN> ioIn<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  50:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  51:</SPAN>    <SPAN CLASS="syntax8">case</SPAN> address <SPAN CLASS="syntax8">of</SPAN>
<SPAN CLASS="gutter">  52:</SPAN>        $D000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$D02E <SPAN CLASS="syntax18">:</SPAN> ioIn <SPAN CLASS="syntax18">:=</SPAN> vicRead<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  53:</SPAN>        $D800<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$DBFF <SPAN CLASS="syntax18">:</SPAN> ioIn <SPAN CLASS="syntax18">:=</SPAN> colorRead<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  54:</SPAN>    <SPAN CLASS="syntax8">else</SPAN>
<SPAN CLASS="gutterH">  55:</SPAN>        ioIn <SPAN CLASS="syntax18">:=</SPAN> $FF
<SPAN CLASS="gutter">  56:</SPAN>    <SPAN CLASS="syntax8">end</SPAN>
<SPAN CLASS="gutter">  57:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  58:</SPAN>
<SPAN CLASS="gutter">  59:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> ioOut<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN> <SPAN CLASS="syntax18">;</SPAN> value <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  60:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  61:</SPAN>        <SPAN CLASS="syntax8">case</SPAN> address <SPAN CLASS="syntax8">of</SPAN>
<SPAN CLASS="gutter">  62:</SPAN>                $D000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$D02E <SPAN CLASS="syntax18">:</SPAN> vicWrite<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">,</SPAN>value<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  63:</SPAN>                $D800<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$DBFF <SPAN CLASS="syntax18">:</SPAN> colorWrite<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">,</SPAN> value<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  64:</SPAN>                $DD00 <SPAN CLASS="syntax18">:</SPAN> vicBank<SPAN CLASS="syntax18">(</SPAN>value<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  65:</SPAN>        <SPAN CLASS="syntax8">else</SPAN>
<SPAN CLASS="gutter">  66:</SPAN>                <SPAN CLASS="syntax18">;</SPAN>       
<SPAN CLASS="gutter">  67:</SPAN>        <SPAN CLASS="syntax8">end</SPAN>     
<SPAN CLASS="gutter">  68:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  69:</SPAN>
<SPAN CLASS="gutterH">  70:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> poke<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN> <SPAN CLASS="syntax18">;</SPAN> value <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  71:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  72:</SPAN>    ram<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN> <SPAN CLASS="syntax18">:=</SPAN> value<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  73:</SPAN>    <SPAN CLASS="syntax8">if</SPAN> <SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">&gt;</SPAN><SPAN CLASS="syntax18">=</SPAN> watchVicFrom<SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax8">and</SPAN> <SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">&lt;</SPAN><SPAN CLASS="syntax18">=</SPAN> watchVicTo<SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax8">then</SPAN> VicText<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">-</SPAN>watchVicFrom<SPAN CLASS="syntax18">,</SPAN>value<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  74:</SPAN>    <SPAN CLASS="syntax8">case</SPAN> address <SPAN CLASS="syntax8">of</SPAN>
<SPAN CLASS="gutterH">  75:</SPAN>        $<SPAN CLASS="syntax5">0001</SPAN>        <SPAN CLASS="syntax18">:</SPAN> ioport<SPAN CLASS="syntax18">(</SPAN>value<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  76:</SPAN>        $D000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$DFFF <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">if</SPAN> hiORlo <SPAN CLASS="syntax8">then</SPAN> ioOut<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">,</SPAN>value<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN> <SPAN CLASS="syntax2">//</SPAN><SPAN CLASS="syntax2">invloed</SPAN><SPAN CLASS="syntax2"> </SPAN><SPAN CLASS="syntax2">charen</SPAN><SPAN CLASS="syntax2"> </SPAN><SPAN CLASS="syntax2">??</SPAN>
<SPAN CLASS="gutter">  77:</SPAN>    <SPAN CLASS="syntax8">end</SPAN>
<SPAN CLASS="gutter">  78:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  79:</SPAN>
<SPAN CLASS="gutterH">  80:</SPAN><SPAN CLASS="syntax8">function</SPAN> peek<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  81:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  82:</SPAN>    <SPAN CLASS="syntax8">case</SPAN> address <SPAN CLASS="syntax8">of</SPAN>
<SPAN CLASS="gutter">  83:</SPAN>        $A000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$BFFF <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">if</SPAN> hiANDlo <SPAN CLASS="syntax8">then</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> basic_rom<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN>
<SPAN CLASS="gutter">  84:</SPAN>                                   <SPAN CLASS="syntax8">else</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> ram<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  85:</SPAN>        $D000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$DFFF <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">if</SPAN> hiORlo <SPAN CLASS="syntax8">then</SPAN> <SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  86:</SPAN>                                           <SPAN CLASS="syntax8">if</SPAN> charen <SPAN CLASS="syntax8">then</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> ioIn<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">)</SPAN>
<SPAN CLASS="gutter">  87:</SPAN>                                                     <SPAN CLASS="syntax8">else</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> char_rom<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  88:</SPAN>                                           <SPAN CLASS="syntax8">end</SPAN>
<SPAN CLASS="gutter">  89:</SPAN>                                   <SPAN CLASS="syntax8">else</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> ram<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH">  90:</SPAN>        $E000<SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$FFFF <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">if</SPAN> hiram <SPAN CLASS="syntax8">then</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> kernal_rom<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN>
<SPAN CLASS="gutter">  91:</SPAN>                                <SPAN CLASS="syntax8">else</SPAN> peek <SPAN CLASS="syntax18">:=</SPAN> ram<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  92:</SPAN>    <SPAN CLASS="syntax8">else</SPAN>
<SPAN CLASS="gutter">  93:</SPAN>        peek <SPAN CLASS="syntax18">:=</SPAN> ram<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN>
<SPAN CLASS="gutter">  94:</SPAN>    <SPAN CLASS="syntax8">end</SPAN>
<SPAN CLASS="gutterH">  95:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  96:</SPAN>
<SPAN CLASS="gutter">  97:</SPAN><SPAN CLASS="syntax8">function</SPAN>  vicPeek<SPAN CLASS="syntax18">(</SPAN>address <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter">  98:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter">  99:</SPAN>    <SPAN CLASS="syntax8">case</SPAN> address <SPAN CLASS="syntax8">of</SPAN>
<SPAN CLASS="gutterH"> 100:</SPAN>                $<SPAN CLASS="syntax5">1000</SPAN><SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$1FFF <SPAN CLASS="syntax18">:</SPAN> vicPeek <SPAN CLASS="syntax18">:=</SPAN> char_rom<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">+</SPAN>$C000<SPAN CLASS="syntax18">]</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 101:</SPAN>                $<SPAN CLASS="syntax5">9000</SPAN><SPAN CLASS="syntax18">.</SPAN><SPAN CLASS="syntax18">.</SPAN>$9FFF <SPAN CLASS="syntax18">:</SPAN> vicPeek <SPAN CLASS="syntax18">:=</SPAN> char_rom<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">+</SPAN>$<SPAN CLASS="syntax5">4000</SPAN><SPAN CLASS="syntax18">]</SPAN>
<SPAN CLASS="gutter"> 102:</SPAN>        <SPAN CLASS="syntax8">else</SPAN>
<SPAN CLASS="gutter"> 103:</SPAN>                vicPeek <SPAN CLASS="syntax18">:=</SPAN> ram<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN>
<SPAN CLASS="gutter"> 104:</SPAN>        <SPAN CLASS="syntax8">end</SPAN>
<SPAN CLASS="gutterH"> 105:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 106:</SPAN>
<SPAN CLASS="gutter"> 107:</SPAN><SPAN CLASS="syntax8">procedure</SPAN> loadrom <SPAN CLASS="syntax18">(</SPAN><SPAN CLASS="syntax8">var</SPAN> rom <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">array</SPAN> <SPAN CLASS="syntax8">of</SPAN> <SPAN CLASS="syntax10">byte</SPAN> <SPAN CLASS="syntax18">;</SPAN> filename<SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">string</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 108:</SPAN><SPAN CLASS="syntax8">var</SPAN>
<SPAN CLASS="gutter"> 109:</SPAN>    f <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax8">file</SPAN> <SPAN CLASS="syntax8">of</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH"> 110:</SPAN>    b <SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">byte</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 111:</SPAN>    address<SPAN CLASS="syntax18">:</SPAN> <SPAN CLASS="syntax10">word</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 112:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter"> 113:</SPAN>        <SPAN CLASS="syntax3">{$</SPAN><SPAN CLASS="syntax3">i-</SPAN><SPAN CLASS="syntax3">}</SPAN>
<SPAN CLASS="gutter"> 114:</SPAN>        assign <SPAN CLASS="syntax18">(</SPAN>f<SPAN CLASS="syntax18">,</SPAN>filename<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH"> 115:</SPAN>        reset<SPAN CLASS="syntax18">(</SPAN>f<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 116:</SPAN>        <SPAN CLASS="syntax3">{$</SPAN><SPAN CLASS="syntax3">i+</SPAN><SPAN CLASS="syntax3">}</SPAN>
<SPAN CLASS="gutter"> 117:</SPAN>        <SPAN CLASS="syntax8">if</SPAN> ioresult <SPAN CLASS="syntax18">&lt;&gt;</SPAN> <SPAN CLASS="syntax5">0</SPAN> <SPAN CLASS="syntax8">then</SPAN>
<SPAN CLASS="gutter"> 118:</SPAN>                <SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter"> 119:</SPAN>                        writeln<SPAN CLASS="syntax18">(</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax13">file</SPAN><SPAN CLASS="syntax13"> </SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax18">,</SPAN>filename<SPAN CLASS="syntax18">,</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax13"> </SPAN><SPAN CLASS="syntax13">is</SPAN><SPAN CLASS="syntax13"> </SPAN><SPAN CLASS="syntax13">missing</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH"> 120:</SPAN>                        readln<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 121:</SPAN>                        halt
<SPAN CLASS="gutter"> 122:</SPAN>                <SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 123:</SPAN>        address <SPAN CLASS="syntax18">:=</SPAN> low<SPAN CLASS="syntax18">(</SPAN>rom<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 124:</SPAN>        <SPAN CLASS="syntax8">while</SPAN> <SPAN CLASS="syntax8">not</SPAN> eof<SPAN CLASS="syntax18">(</SPAN>f<SPAN CLASS="syntax18">)</SPAN> <SPAN CLASS="syntax8">do</SPAN>
<SPAN CLASS="gutterH"> 125:</SPAN>        <SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutter"> 126:</SPAN>                <SPAN CLASS="syntax9">read</SPAN><SPAN CLASS="syntax18">(</SPAN>f<SPAN CLASS="syntax18">,</SPAN>b<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 127:</SPAN>                rom<SPAN CLASS="syntax18">[</SPAN>address<SPAN CLASS="syntax18">]</SPAN> <SPAN CLASS="syntax18">:=</SPAN> b<SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 128:</SPAN>                inc<SPAN CLASS="syntax18">(</SPAN>address<SPAN CLASS="syntax18">)</SPAN>
<SPAN CLASS="gutter"> 129:</SPAN>        <SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH"> 130:</SPAN>        close<SPAN CLASS="syntax18">(</SPAN>f<SPAN CLASS="syntax18">)</SPAN>
<SPAN CLASS="gutter"> 131:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 132:</SPAN>
<SPAN CLASS="gutter"> 133:</SPAN><SPAN CLASS="syntax8">initialization</SPAN>
<SPAN CLASS="gutter"> 134:</SPAN><SPAN CLASS="syntax8">begin</SPAN>
<SPAN CLASS="gutterH"> 135:</SPAN>    loadrom<SPAN CLASS="syntax18">(</SPAN>kernal_rom<SPAN CLASS="syntax18">,</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax13">kernal.rom</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 136:</SPAN>    loadrom<SPAN CLASS="syntax18">(</SPAN>basic_rom<SPAN CLASS="syntax18">,</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax13">basic.rom</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 137:</SPAN>    loadrom<SPAN CLASS="syntax18">(</SPAN>char_rom<SPAN CLASS="syntax18">,</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax13">char.rom</SPAN><SPAN CLASS="syntax13">'</SPAN><SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 138:</SPAN>    poke <SPAN CLASS="syntax18">(</SPAN><SPAN CLASS="syntax5">0</SPAN><SPAN CLASS="syntax18">,</SPAN>$FF<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 139:</SPAN>    poke <SPAN CLASS="syntax18">(</SPAN><SPAN CLASS="syntax5">1</SPAN><SPAN CLASS="syntax18">,</SPAN>$FF<SPAN CLASS="syntax18">)</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutterH"> 140:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">;</SPAN>
<SPAN CLASS="gutter"> 141:</SPAN>
<SPAN CLASS="gutter"> 142:</SPAN><SPAN CLASS="syntax8">end</SPAN><SPAN CLASS="syntax18">.</SPAN>
</PRE></BODY>
</HTML>

